function dx = Paper(beta0,alpha,gama,p,mu,phi,omega,tau,lambda,x0,tf)

%Delays
lags = [tau tau tau];

function dydt = ddefun(t,y,Z)
  %Function that has the model with the delay tau for the recovered nodes
  ylag1 = Z(:,1);
  ylag2 = Z(:,2);
  ylag3 = Z(:,3);

  %Model 
  dydt = [p*lambda-(beta0/(1+alpha*y(2)))*y(1)*y(2)-(mu+phi)*y(1)+omega*ylag3(3); 
          (beta0/(1+alpha*y(2)))*y(1)*y(2)-(mu+gama)*y(2); 
          (1-p)*lambda+phi*y(1)+gama*y(2)-omega*ylag3(3)-mu*y(3)];
end

function s = history(t)
  %Initial condition
  s = x0;
end

%Time interval
tspan = [0 tf];

%Solution of the model with dde23
sol = dde23(@ddefun, lags, @history, tspan);


%Graph
plot(sol.x,sol.y)
legend('Suscpetible (S)','Infected (I)','Recovered (R)');

end